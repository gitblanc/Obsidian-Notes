# 13 Octubre 2022 
---
- Ahora vamos a utilizar el modelo de dominio, que hace que el esfuerzo de implementaci贸n sea mucho m谩s estable
- **Mapeadores Objeto-Relacional**
	- Permite la persistencia y es transparente a objetos en BBDD relacionales
	- M铆nima intrusividad en el c贸digo
	- Soporta concurrencia
	- Se programa pensando en objetos
	- No es necesario escribir JDBC

Diferencias estructurales y din谩micas entre modelo relacional y modelo OO:
- **Estructurales**
	- **Granularidad**: hay varios tipos de clases (entidades y value types)
	- **Identidad**: en java el == o el equals o el hashCode, en BDD relacional la clave primaria define la identidad
	- **Subtipado**
	- **Asociaciones**: *navegabilidad* (unidireccional o bidireccional) y *cardinalidad* (uno a uno, uno a muchos, muchos a muchos)
- **Din谩micas**: generan p茅rdidas de eficiencia en tiempo de ejecuci贸n
	- **Navegaci贸n**: *eager loading* (se carga un objeto y sus asociados, puede sobrecargar la memoria con objetos no necesarios) y *lazy loading* (se carga s贸lo lo necesario, pero genera el problema de las n+1 consultas)
	- **Cacheado**: optimiza el rendimiento al reducir el trasiedo de la BBDD y permite hacer optimizaciones (write-behind delayed o batch load/update)
	- **Concurrencia**: si hay varios hilos de ejecuci贸n se crea una cach茅 por hilo y la BDD gestiona las transacciones

---
# 20 Octubre 2022 
## Gesti贸n de objetos persistentes en JPA

Ciclo de vida de un objeto:
- new
- en memoria
- a la basura

- Con un **mapeador** entrando en juego, el estado de memoria se divide en tres estados diferentes:
	- **transient**: cuando no tengo el mapeador y hago un new(), el objeto est谩 煤nicamente en memoria (no existe en la bbdd)
	- **persistent**: existe en la base de datos, y est谩 vigilado por el mapeador (si se hacen modificaciones de escritura, se sobreescriben en la base de datos). Vamos de transient a persistent a trav茅s del m茅todo *persist()*. Es un estado gestionado
	- **detached**: un objeto que sigue en memoria despue茅s de la sesi贸n. Existe en Java y en la BBDD
- El merge crea un nuevo objeto  y lo devuelve

## Mapeo de clases
- La informaci贸n necesaria para persistir objetos se a帽ade en forma de metadatos (anotaciones en el c贸digo)


---