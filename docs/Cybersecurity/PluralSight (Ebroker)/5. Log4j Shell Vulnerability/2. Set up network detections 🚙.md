We will use the Linux tool **screen** to manage multiple terminals:

````
screen -S suricata
````
Now we can start the tool **Suricata**, which is an IDS (Intrusion Detection System) and will alert when network traffic matches certain criteria

````
sudo suricata -S ~/lab/emerging-threats-log4j.rules -l ~/lab -i eth0
````
NOTES:
- the file .rules contains signatures extracted from the emerging-threats database, but only those that pertain to Log4j (available on Github resources page)
- the -l option specifies the logging directory

![](img/suricata.png)

To detach from a screen session yopu can press Ctrl+A, let go, then D. This will return you back to the original terminal

Now create a new screen session for the tool **tcpdump** 
````
screen -S tcpdump
````
Start tcpdump:
````
sudo tcpdump -nn 'not port 22 and not port 443' -w analysis.pcap
````
Detach again.
NOTES:
- the -nn option prevent tcpdump for making hostname or port resolutions
- the -w option allows to write the captured traffic to a file

- If you pur `screen -ls` it will list out all the current sessions (tcpdump and suricata)
- Check the application /temp directory: 
````
sudo docker exec vulnapp2 ls /temp 
````